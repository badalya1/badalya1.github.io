import{J as b,p as h,M as _,N as g,O,y as D,z as w,u as x,P as E,Q as B}from"./entry.d68c5e71.js";const C=()=>null;function k(...s){var v;const y=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(y);let[n,l,a={}]=s;if(typeof n!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof l!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??C,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const t=b(),p=()=>t.isHydrating?t.payload.data[n]:t.static.data[n],o=()=>p()!==void 0;t._asyncData[n]||(t._asyncData[n]={data:h(p()??((v=a.default)==null?void 0:v.call(a))??null),pending:h(!o()),error:h(t.payload._errors[n]?_(t.payload._errors[n]):null)});const e={...t._asyncData[n]};e.refresh=e.execute=(i={})=>{if(t._asyncDataPromises[n]){if(i.dedupe===!1)return t._asyncDataPromises[n];t._asyncDataPromises[n].cancelled=!0}if(i._initial&&o())return p();e.pending.value=!0;const u=new Promise((r,f)=>{try{r(l(t))}catch(P){f(P)}}).then(r=>{if(u.cancelled)return t._asyncDataPromises[n];a.transform&&(r=a.transform(r)),a.pick&&(r=j(r,a.pick)),e.data.value=r,e.error.value=null}).catch(r=>{var f;if(u.cancelled)return t._asyncDataPromises[n];e.error.value=r,e.data.value=x(((f=a.default)==null?void 0:f.call(a))??null)}).finally(()=>{u.cancelled||(e.pending.value=!1,t.payload.data[n]=e.data.value,e.error.value&&(t.payload._errors[n]=_(e.error.value)),delete t._asyncDataPromises[n])});return t._asyncDataPromises[n]=u,t._asyncDataPromises[n]};const c=()=>e.refresh({_initial:!0}),d=a.server!==!1&&t.payload.serverRendered;{const i=g();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const r=i._nuxtOnBeforeMountCbs;i&&(O(()=>{r.forEach(f=>{f()}),r.splice(0,r.length)}),D(()=>r.splice(0,r.length)))}d&&t.isHydrating&&o()?e.pending.value=!1:i&&(t.payload.serverRendered&&t.isHydrating||a.lazy)&&a.immediate?i._nuxtOnBeforeMountCbs.push(c):a.immediate&&c(),a.watch&&w(a.watch,()=>e.refresh());const u=t.hook("app:data:refresh",r=>{if(!r||r.includes(n))return e.refresh()});i&&D(u)}const m=Promise.resolve(t._asyncDataPromises[n]).then(()=>e);return Object.assign(m,e),m}function j(s,y){const n={};for(const l of y)n[l]=s[l];return n}const S=()=>{const s=E();return B()!=="v4"&&console.warn("useStrapi4 is only available for v4"),{find:(o,e)=>s(`/${o}`,{method:"GET",params:e}),findOne:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"GET",params:c})},create:(o,e)=>s(`/${o}`,{method:"POST",body:{data:e}}),update:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"PUT",body:{data:c}})},delete:(o,e)=>{const c=[o,e].filter(Boolean).join("/");return s(c,{method:"DELETE"})}}},M=()=>S();export{k as a,M as u};
