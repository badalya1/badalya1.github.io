import{x as h,$ as D,a0 as g,B as v,C as b,Q as P,g as x,a1 as w,a2 as O,a3 as B,a4 as C}from"./entry.6a1cbea8.js";const E=()=>null;function k(...s){const y=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(y);let[a,l,n={}]=s;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof l!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");n.server=n.server??!0,n.default=n.default??E,n.lazy=n.lazy??!1,n.immediate=n.immediate??!0;const t=P(),p=()=>t.isHydrating?t.payload.data[a]:t.static.data[a],o=()=>p()!==void 0;t._asyncData[a]||(t._asyncData[a]={data:h(p()??n.default()),pending:h(!o()),error:D(t.payload._errors,a),status:h("idle")});const e={...t._asyncData[a]};e.refresh=e.execute=(i={})=>{if(t._asyncDataPromises[a]){if(i.dedupe===!1)return t._asyncDataPromises[a];t._asyncDataPromises[a].cancelled=!0}if((i._initial||t.isHydrating&&i._initial!==!1)&&o())return p();e.pending.value=!0,e.status.value="pending";const f=new Promise((r,u)=>{try{r(l(t))}catch(_){u(_)}}).then(r=>{if(f.cancelled)return t._asyncDataPromises[a];let u=r;n.transform&&(u=n.transform(r)),n.pick&&(u=j(u,n.pick)),e.data.value=u,e.error.value=null,e.status.value="success"}).catch(r=>{if(f.cancelled)return t._asyncDataPromises[a];e.error.value=r,e.data.value=x(n.default()),e.status.value="error"}).finally(()=>{f.cancelled||(e.pending.value=!1,t.payload.data[a]=e.data.value,e.error.value&&(t.payload._errors[a]=w(e.error.value)),delete t._asyncDataPromises[a])});return t._asyncDataPromises[a]=f,t._asyncDataPromises[a]};const c=()=>e.refresh({_initial:!0}),d=n.server!==!1&&t.payload.serverRendered;{const i=O();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const r=i._nuxtOnBeforeMountCbs;i&&(g(()=>{r.forEach(u=>{u()}),r.splice(0,r.length)}),v(()=>r.splice(0,r.length)))}d&&t.isHydrating&&o()?(e.pending.value=!1,e.status.value=e.error.value?"error":"success"):i&&(t.payload.serverRendered&&t.isHydrating||n.lazy)&&n.immediate?i._nuxtOnBeforeMountCbs.push(c):n.immediate&&c(),n.watch&&b(n.watch,()=>e.refresh());const f=t.hook("app:data:refresh",r=>{if(!r||r.includes(a))return e.refresh()});i&&v(f)}const m=Promise.resolve(t._asyncDataPromises[a]).then(()=>e);return Object.assign(m,e),m}function j(s,y){const a={};for(const l of y)a[l]=s[l];return a}const S=()=>{const s=B();return C()!=="v4"&&console.warn("useStrapi4 is only available for v4"),{find:(o,e)=>s(`/${o}`,{method:"GET",params:e}),findOne:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"GET",params:c})},create:(o,e)=>s(`/${o}`,{method:"POST",body:{data:e}}),update:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"PUT",body:{data:c}})},delete:(o,e)=>{const c=[o,e].filter(Boolean).join("/");return s(c,{method:"DELETE"})}}},M=()=>S();export{k as a,M as u};
