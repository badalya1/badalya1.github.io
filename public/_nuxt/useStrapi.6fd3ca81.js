import{J as D,v as m,O as P,P as b,A as v,B as g,u as O,Q as w,R as x,S as B,U as E}from"./entry.aac4f71d.js";const C=()=>null;function k(...s){const y=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(y);let[a,l,n={}]=s;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof l!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");n.server=n.server??!0,n.default=n.default??C,n.lazy=n.lazy??!1,n.immediate=n.immediate??!0;const t=D(),p=()=>t.isHydrating?t.payload.data[a]:t.static.data[a],o=()=>p()!==void 0;t._asyncData[a]||(t._asyncData[a]={data:m(p()??n.default()),pending:m(!o()),error:P(t.payload._errors,a)});const e={...t._asyncData[a]};e.refresh=e.execute=(i={})=>{if(t._asyncDataPromises[a]){if(i.dedupe===!1)return t._asyncDataPromises[a];t._asyncDataPromises[a].cancelled=!0}if((i._initial||t.isHydrating&&i._initial!==!1)&&o())return p();e.pending.value=!0;const u=new Promise((r,f)=>{try{r(l(t))}catch(_){f(_)}}).then(r=>{if(u.cancelled)return t._asyncDataPromises[a];let f=r;n.transform&&(f=n.transform(r)),n.pick&&(f=S(f,n.pick)),e.data.value=f,e.error.value=null}).catch(r=>{if(u.cancelled)return t._asyncDataPromises[a];e.error.value=r,e.data.value=O(n.default())}).finally(()=>{u.cancelled||(e.pending.value=!1,t.payload.data[a]=e.data.value,e.error.value&&(t.payload._errors[a]=w(e.error.value)),delete t._asyncDataPromises[a])});return t._asyncDataPromises[a]=u,t._asyncDataPromises[a]};const c=()=>e.refresh({_initial:!0}),d=n.server!==!1&&t.payload.serverRendered;{const i=x();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const r=i._nuxtOnBeforeMountCbs;i&&(b(()=>{r.forEach(f=>{f()}),r.splice(0,r.length)}),v(()=>r.splice(0,r.length)))}d&&t.isHydrating&&o()?e.pending.value=!1:i&&(t.payload.serverRendered&&t.isHydrating||n.lazy)&&n.immediate?i._nuxtOnBeforeMountCbs.push(c):n.immediate&&c(),n.watch&&g(n.watch,()=>e.refresh());const u=t.hook("app:data:refresh",r=>{if(!r||r.includes(a))return e.refresh()});i&&v(u)}const h=Promise.resolve(t._asyncDataPromises[a]).then(()=>e);return Object.assign(h,e),h}function S(s,y){const a={};for(const l of y)a[l]=s[l];return a}const j=()=>{const s=B();return E()!=="v4"&&console.warn("useStrapi4 is only available for v4"),{find:(o,e)=>s(`/${o}`,{method:"GET",params:e}),findOne:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"GET",params:c})},create:(o,e)=>s(`/${o}`,{method:"POST",body:{data:e}}),update:(o,e,c)=>{typeof e=="object"&&(c=e,e=void 0);const d=[o,e].filter(Boolean).join("/");return s(d,{method:"PUT",body:{data:c}})},delete:(o,e)=>{const c=[o,e].filter(Boolean).join("/");return s(c,{method:"DELETE"})}}},M=()=>j();export{k as a,M as u};
